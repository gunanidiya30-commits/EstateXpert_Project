<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ROI & Loan Eligibility</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-light">

<div class="container mt-5">
    <div class="card shadow-lg border-0">
        <div class="card-header bg-primary text-white">
            <h4 class="mb-0">ROI & Loan Eligibility Calculator</h4>
<small class="text-white-50">
    Understand returns and loan affordability before investing
</small>

        </div>
        <div class="card-body">

            <p class="text-muted mb-4">
    Enter realistic values below to estimate your property return and check if you qualify for a loan.
</p>

<h5 class="mb-3 text-primary">Investment & Income Details</h5>

            <div class="row g-3">
                <div class="col-md-6">
                    <label class="form-label">Property Price (₹)</label>
                    <input type="number" id="property_price" class="form-control" placeholder="e.g. 5000000">
                </div>

                <div class="col-md-6">
                    <label class="form-label">Expected Annual Return (%)</label>
                   <input type="number" id="expected_annual_return" class="form-control" placeholder="e.g. 8">
                </div>

                <div class="col-md-6">
                    <label class="form-label">Investment Years</label>
                    <input type="number" id="investment_years" class="form-control" placeholder="e.g. 10">
                </div>

                <div class="col-md-6">
                    <label class="form-label">Annual Income (₹)</label>
                    <input type="number" id="annual_income" class="form-control" placeholder="e.g. 1200000">
                </div>

                <div class="col-md-6">
                    <label class="form-label">Existing Monthly EMI (₹)</label>
                    <input type="number" id="existing_emi" class="form-control" placeholder="e.g. 15000 (0 if none)">
                </div>
            </div>

            <div class="mt-4">
                <button class="btn btn-success" onclick="calculateROI()">Calculate</button>
            </div>

            <hr>
<h5 class="mt-4 text-success">Calculation Result</h5>


           <div id="result" class="mt-4 p-3 rounded bg-white border"></div>
<canvas id="roiChart" class="mt-4" height="120"></canvas>

<div id="eligibilityExplanation"
     class="alert alert-secondary mt-3"
     style="display:none;">
    <h6>How loan eligibility is calculated</h6>
   <ul class="mb-0">
    <li>
        Banks typically allow your total EMIs to be up to
        <strong>40% of your monthly income</strong>.
    </li>
    <li>
        Your existing EMIs are subtracted from this limit to calculate
        your <strong>remaining EMI capacity</strong>.
    </li>
    <li>
        If your remaining capacity is greater than zero, you are marked
        <strong>ELIGIBLE</strong>; otherwise, <strong>NOT ELIGIBLE</strong>.
    </li>
</ul>

</div>

<div class="mt-4 alert alert-secondary">
    <h5 class="mb-3">How to interpret the result</h5>

    <h6>How to read these results</h6>
    <ul class="mb-0">
        <li>
            <strong>ROI Percentage:</strong>
            Shows how much your property investment grows over time based on the expected annual return.
        </li>
        <li>
            <strong>Eligible Loan Amount:</strong>
            Calculated using a safe rule where your total EMIs should not exceed 40% of your monthly income.
        </li>
        <li>
            <strong>Status:</strong>
            <em>ELIGIBLE</em> means you can safely take a loan,  
            <em>NOT ELIGIBLE</em> means your current income or EMIs are too high.
        </li>
    </ul>
</div>


        </div>
    </div>
</div>

<script>
function calculateROI() {
    const property_price = document.getElementById("property_price").value;
    const expected_annual_return = document.getElementById("expected_annual_return").value;
    const investment_years = document.getElementById("investment_years").value;
    const annual_income = document.getElementById("annual_income").value;
    const existing_emi = document.getElementById("existing_emi").value;

    if (
        !property_price ||
        !expected_annual_return ||
        !investment_years ||
        !annual_income ||
        existing_emi === ""
    ) {
        document.getElementById("result").innerHTML =
            `<div class="alert alert-danger">All fields are mandatory.</div>`;
        return;
    }

    if (
        property_price <= 0 ||
        expected_annual_return <= 0 ||
        investment_years <= 0 ||
        annual_income <= 0 ||
        existing_emi < 0
    ) {
        document.getElementById("result").innerHTML =
            `<div class="alert alert-danger">Please enter valid positive numbers.</div>`;
        return;
    }

    const data = {
        property_price,
        expected_annual_return,
        investment_years,
        annual_income,
        existing_emi
    };

    fetch("http://127.0.0.1:5000/roi_loan_eligibility", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
    })
    .then(res => res.json())
    .then(result => {
        if (result.error) {
            document.getElementById("result").innerHTML =
                `<div class="alert alert-danger">${result.error}</div>`;
            return;
        }

       const statusColor =
    result.eligibility_status === "ELIGIBLE"
        ? "success"
        : "danger";

document.getElementById("result").innerHTML = `
    <div class="alert alert-${statusColor}">
        <p><strong>ROI Percentage:</strong> ${result.roi_percentage}%</p>
        <p><strong>Eligible Loan Amount:</strong> ₹${result.eligible_loan_amount}</p>
        <p>
            <strong>Status:</strong>
            <span class="fw-bold text-uppercase">
                ${result.eligibility_status}
            </span>
        </p>
    </div>
`;
document.getElementById("eligibilityExplanation").style.display = "block";


const ctx = document.getElementById('roiChart').getContext('2d');
if (window.roiChartInstance) {
    window.roiChartInstance.destroy();
}

window.roiChartInstance = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ['ROI %'],
        datasets: [{
            label: 'Return on Investment',
            data: [result.roi_percentage],
            backgroundColor: ['#0d6efd']
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});

    });
}
</script>


</body>
</html>
