<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Rent vs Buy | EstateXpert</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-5">
    <h2 class="mb-4">Rent vs Buy Calculator</h2>

    <form id="rentBuyForm">

        <div class="mb-3">
            <label class="form-label">Monthly Rent (₹)</label>
            <input type="number" class="form-control" id="monthlyRent" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Property Price (₹)</label>
            <input type="number" class="form-control" id="propertyPrice" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Down Payment (₹)</label>
            <input type="number" class="form-control" id="downPayment" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Loan Interest Rate (%)</label>
            <input type="number" step="0.01" class="form-control" id="loanInterestRate" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Loan Tenure (Years)</label>
            <input type="number" class="form-control" id="loanTenureYears" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Annual Rent Increase (%)</label>
            <input type="number" step="0.01" class="form-control" id="annualRentIncrease" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Annual Property Appreciation (%)</label>
            <input type="number" step="0.01" class="form-control" id="annualPropertyAppreciation" required>
        </div>

        <button type="submit" class="btn btn-primary">
            Compare Rent vs Buy
        </button>

    </form>

    <hr class="my-4">

    <!-- FIXED: space between id and class -->
    <div id="recommendationExplanation" class="alert alert-secondary mt-3" style="display:none;">
        <p><strong>Total Rent Paid:</strong> —</p>
        <p><strong>Future Property Value:</strong> —</p>
        <p><strong>Recommendation:</strong> —</p>
    </div>

    <div class="text-muted mt-2">
    <small>
        <span class="text-success">Green</span> = Cost‑effective choice &nbsp;|&nbsp;
        <span class="text-warning">Orange</span> = More flexible option
    </small>
</div>

    <div id="recommendationExplanation"
         class="alert alert-secondary mt-3"
         style="display:none;">
        <h6>Why this recommendation?</h6>
        <p id="recommendationText" class="mb-0"></p>
    </div>

</div>

<script>
document.getElementById("rentBuyForm").addEventListener("submit", function (e) {
    e.preventDefault();

    const payload = {
        monthly_rent: document.getElementById("monthlyRent").value,
        property_price: document.getElementById("propertyPrice").value,
        down_payment: document.getElementById("downPayment").value,
        loan_interest_rate: document.getElementById("loanInterestRate").value,
        loan_tenure_years: document.getElementById("loanTenureYears").value,
        annual_rent_increase: document.getElementById("annualRentIncrease").value,
        annual_property_appreciation: document.getElementById("annualPropertyAppreciation").value
    };

    fetch("http://127.0.0.1:5000/rent_vs_buy", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
    })
    .then(response => response.json())
    .then(data => {
        if (data.error) {
            alert(data.error);
            return;
        }

        document.getElementById("rentBuyResult").innerHTML = `
            <p class="fs-5">
                <strong>Recommendation:</strong>
                <span class="fw-bold text-success">${data.recommendation}</span>
            </p>
            <p><strong>Future Property Value:</strong> ₹ ${data.future_property_value}</p>
        `;

        const explanationDiv = document.getElementById("recommendationExplanation");
        const explanationText = document.getElementById("recommendationText");

        if (data.recommendation === "BUY") {
            explanationText.innerText =
                "Buying is recommended because your total buying cost is lower than the total rent cost over the selected period. This makes buying more cost‑effective in the long term.";
        } else {
            explanationText.innerText =
                "Renting is recommended because your total rent cost is lower than the total buying cost for the selected duration, helping you save money and stay flexible.";
        }

        explanationDiv.style.display = "block";
    })
    .catch(error => {
        console.error(error);
        alert("Failed to compare Rent vs Buy");
    });
});
</script>

</body>
</html>
